# è¹¦è·³å°ç«ç®­ V2.0 - é—®é¢˜è¯Šæ–­æŒ‡å—

## ğŸ” é—®é¢˜è¯Šæ–­æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥ä¸²å£è¾“å‡º
çƒ§å½•æ–°çš„è°ƒè¯•ç‰ˆæœ¬å¹¶è§‚å¯Ÿä¸²å£è¾“å‡ºï¼š

```bash
pio run --target upload
pio device monitor
```

### ç¬¬äºŒæ­¥ï¼šåˆ†æå¯åŠ¨æ—¥å¿—

#### 1. ç³»ç»Ÿä¿¡æ¯æ£€æŸ¥
åº”è¯¥çœ‹åˆ°ï¼š
```
========================================
è¹¦è·³å°ç«ç®­ V2.0 å¯åŠ¨
========================================
ESP32 èŠ¯ç‰‡å‹å·: ESP32-D0WDQ6
èŠ¯ç‰‡ç‰ˆæœ¬: 1
CPUé¢‘ç‡: 240 MHz
ç©ºé—²å †å†…å­˜: XXXXX bytes
```

#### 2. I2Cè®¾å¤‡æ‰«æç»“æœ
**æ­£å¸¸æƒ…å†µ**ï¼š
```
ğŸ” å¼€å§‹I2Cè®¾å¤‡æ‰«æ...
âœ… å‘ç°I2Cè®¾å¤‡ï¼Œåœ°å€: 0x3C (OLED SSD1306) â­
âœ… å‘ç°I2Cè®¾å¤‡ï¼Œåœ°å€: 0x68 (MPU6050) â­
âœ… æ€»å…±å‘ç° 2 ä¸ªI2Cè®¾å¤‡
ğŸ‰ æ‰€æœ‰å…³é”®è®¾å¤‡éƒ½å·²æ‰¾åˆ°ï¼
```

**å¼‚å¸¸æƒ…å†µ**ï¼š
- å¦‚æœæ˜¾ç¤º"âŒ æœªå‘ç°ä»»ä½•I2Cè®¾å¤‡"ï¼Œæ£€æŸ¥ç¡¬ä»¶è¿æ¥
- å¦‚æœåªå‘ç°éƒ¨åˆ†è®¾å¤‡ï¼Œæ£€æŸ¥å¯¹åº”è®¾å¤‡çš„è¿æ¥

#### 3. OLEDåˆå§‹åŒ–æ£€æŸ¥
**æ­£å¸¸æƒ…å†µ**ï¼š
```
ğŸ–¥ï¸  æ˜¾ç¤ºä»»åŠ¡å¯åŠ¨
ğŸ–¥ï¸  å¼€å§‹U8g2 OLEDåˆå§‹åŒ–...
âœ… OLED I2Cè¿æ¥æˆåŠŸ
âœ… U8g2åº“åˆå§‹åŒ–æˆåŠŸ
âœ… å­—ä½“å’Œæ˜¾ç¤ºå‚æ•°è®¾ç½®å®Œæˆ
âœ… æ¸…å±æµ‹è¯•å®Œæˆ
ğŸ‰ U8g2 OLEDåˆå§‹åŒ–å®Œå…¨æˆåŠŸ
```

**å¼‚å¸¸æƒ…å†µ**ï¼š
- "âŒ OLED I2Cè¿æ¥å¤±è´¥" â†’ æ£€æŸ¥OLEDè¿æ¥
- "âŒ U8g2åº“åˆå§‹åŒ–å¤±è´¥" â†’ å¯èƒ½æ˜¯åº“ç‰ˆæœ¬é—®é¢˜

#### 4. MPU6050åˆå§‹åŒ–æ£€æŸ¥
**æ­£å¸¸æƒ…å†µ**ï¼š
```
ğŸ”§ å¼€å§‹Adafruit MPU6050åˆå§‹åŒ–...
âœ… MPU6050 I2Cè¿æ¥æˆåŠŸ
âœ… MPU6050åº“åˆå§‹åŒ–æˆåŠŸ
âœ… ä¼ æ„Ÿå™¨æµ‹è¯•æˆåŠŸ - åŠ é€Ÿåº¦: X=0.12, Y=0.05, Z=9.78 m/sÂ²
```

**å¼‚å¸¸æƒ…å†µ**ï¼š
- "âŒ MPU6050 I2Cè¿æ¥å¤±è´¥" â†’ æ£€æŸ¥MPU6050è¿æ¥
- "âŒ ä¼ æ„Ÿå™¨æ•°æ®è¯»å–æµ‹è¯•å¤±è´¥" â†’ ä¼ æ„Ÿå™¨å¯èƒ½æŸå

### ç¬¬ä¸‰æ­¥ï¼šç¡¬ä»¶è¿æ¥éªŒè¯

#### OLED SSD1306 è¿æ¥
```
OLEDå¼•è„š    ESP32å¼•è„š
VCC    â†’    3.3V
GND    â†’    GND
SCL    â†’    GPIO22
SDA    â†’    GPIO21
```

#### MPU6050 è¿æ¥
```
MPU6050å¼•è„š  ESP32å¼•è„š
VCC    â†’    3.3V
GND    â†’    GND
SCL    â†’    GPIO22 (ä¸OLEDå…±äº«)
SDA    â†’    GPIO21 (ä¸OLEDå…±äº«)
```

#### å…¶ä»–ç¡¬ä»¶
```
æŒ‰é’®ï¼šä¸€ç«¯ â†’ GPIO2ï¼Œå¦ä¸€ç«¯ â†’ GND
èœ‚é¸£å™¨ï¼šæ­£æ â†’ GPIO25ï¼Œè´Ÿæ â†’ GND
```

### ç¬¬å››æ­¥ï¼šè·³è·ƒæ£€æµ‹è°ƒè¯•

#### å¯ç”¨è¯¦ç»†è°ƒè¯•
åœ¨sensor.cppä¸­ä¿®æ”¹ï¼š
```cpp
#define DEBUG_SENSOR_DATA       true    // å¯ç”¨ä¼ æ„Ÿå™¨æ•°æ®è¾“å‡º
#define DEBUG_JUMP_DETECTION    true    // å¯ç”¨è·³è·ƒæ£€æµ‹è°ƒè¯•
```

#### è§‚å¯Ÿè·³è·ƒæ£€æµ‹æ—¥å¿—
**æ­£å¸¸è·³è·ƒ**ï¼š
```
ğŸš€ è·³è·ƒå¼€å§‹æ£€æµ‹ï¼Œå¹…å€¼: 1.45 (é˜ˆå€¼: 1.30)
ğŸ“‰ è·³è·ƒä¸‹é™é˜¶æ®µï¼Œå¹…å€¼: 0.65 (é˜ˆå€¼: 0.70)
âœ… è·³è·ƒæ£€æµ‹æˆåŠŸï¼æŒç»­æ—¶é—´: 234 ms, å¹…å€¼: 0.98
```

**å¼‚å¸¸æƒ…å†µ**ï¼š
- æŒç»­æ˜¾ç¤º"â° è·³è·ƒæ£€æµ‹è¶…æ—¶" â†’ é˜ˆå€¼è®¾ç½®ä¸å½“
- æ²¡æœ‰è·³è·ƒå¼€å§‹æ£€æµ‹ â†’ é˜ˆå€¼è¿‡é«˜æˆ–ä¼ æ„Ÿå™¨æ— å“åº”
- è·³è·ƒæŒç»­æ—¶é—´ä¸ç¬¦åˆè¦æ±‚ â†’ è°ƒæ•´æ—¶é—´å‚æ•°

## ğŸ› ï¸ å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šOLEDå®Œå…¨é»‘å±

#### å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆï¼š

1. **I2Cè¿æ¥é—®é¢˜**
   - æ£€æŸ¥SDA/SCLå¼•è„šè¿æ¥
   - ç¡®è®¤3.3Vä¾›ç”µï¼ˆä¸æ˜¯5Vï¼ï¼‰
   - æ£€æŸ¥GNDè¿æ¥

2. **I2Cåœ°å€é”™è¯¯**
   - å¤§å¤šæ•°SSD1306æ˜¯0x3C
   - å°‘æ•°å¯èƒ½æ˜¯0x3D
   - æŸ¥çœ‹I2Cæ‰«æç»“æœç¡®è®¤

3. **åº“ç‰ˆæœ¬é—®é¢˜**
   - ç¡®è®¤ä½¿ç”¨U8g2 2.35.9ç‰ˆæœ¬
   - å°è¯•é‡æ–°å®‰è£…åº“

4. **æ˜¾ç¤ºå™¨ä»¶æ•…éšœ**
   - æ›´æ¢OLEDæ¨¡å—æµ‹è¯•
   - æ£€æŸ¥ç„Šæ¥è´¨é‡

### é—®é¢˜2ï¼šè·³è·ƒæ£€æµ‹æŒç»­è¶…æ—¶

#### å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆï¼š

1. **ä¼ æ„Ÿå™¨è¿æ¥é—®é¢˜**
   - æ£€æŸ¥MPU6050çš„I2Cè¿æ¥
   - ç¡®è®¤ä¼ æ„Ÿå™¨ä¾›ç”µæ­£å¸¸

2. **é˜ˆå€¼è®¾ç½®ä¸å½“**
   - å½“å‰è®¾ç½®ï¼šé«˜é˜ˆå€¼1.3gï¼Œä½é˜ˆå€¼0.7g
   - å¯ä»¥è°ƒæ•´ä¸ºï¼šé«˜é˜ˆå€¼1.1gï¼Œä½é˜ˆå€¼0.8g

3. **ä¼ æ„Ÿå™¨æ–¹å‘é—®é¢˜**
   - ç¡®ä¿Zè½´å‚ç›´å‘ä¸Š
   - æ£€æŸ¥ä¼ æ„Ÿå™¨å®‰è£…æ–¹å‘

4. **ç¯å¢ƒå¹²æ‰°**
   - é¿å…éœ‡åŠ¨ç¯å¢ƒ
   - ç¡®ä¿è®¾å¤‡ç¨³å®šæ”¾ç½®

### é—®é¢˜3ï¼šæ˜¾ç¤ºä»»åŠ¡å¯åŠ¨å¤±è´¥

#### è§£å†³æ–¹æ¡ˆï¼š
1. å¢åŠ ä»»åŠ¡æ ˆå¤§å°
2. æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ
3. ç¡®è®¤ä»»åŠ¡åˆ›å»ºé¡ºåº

## ğŸ”§ è°ƒè¯•å‚æ•°è°ƒæ•´

### è·³è·ƒæ£€æµ‹å‚æ•°ä¼˜åŒ–
```cpp
// åœ¨sensor.cppä¸­è°ƒæ•´è¿™äº›å€¼
#define JUMP_THRESHOLD_HIGH     1.1f    // é™ä½ä»¥æé«˜çµæ•åº¦
#define JUMP_THRESHOLD_LOW      0.8f    // æé«˜ä»¥å‡å°‘è¯¯è§¦
#define JUMP_MIN_DURATION       30      // æœ€å°æŒç»­æ—¶é—´
#define JUMP_MAX_DURATION       1000    // æœ€å¤§æŒç»­æ—¶é—´
#define JUMP_COOLDOWN           150     // å†·å´æ—¶é—´
```

### I2Cæ—¶é’Ÿé¢‘ç‡è°ƒæ•´
```cpp
// åœ¨hardware.cppä¸­è°ƒæ•´
Wire.setClock(50000);  // é™ä½åˆ°50kHzæé«˜ç¨³å®šæ€§
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å†…å­˜ä½¿ç”¨ç›‘æ§
æ·»åŠ åˆ°main.cppçš„loop()ä¸­ï¼š
```cpp
static uint32_t last_memory_check = 0;
if (millis() - last_memory_check >= 10000) {
    Serial.printf("ç©ºé—²å †å†…å­˜: %d bytes\n", ESP.getFreeHeap());
    last_memory_check = millis();
}
```

### ä»»åŠ¡çŠ¶æ€ç›‘æ§
```cpp
// æ£€æŸ¥ä»»åŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
if (uxTaskGetStackHighWaterMark(NULL) < 100) {
    Serial.println("è­¦å‘Šï¼šä»»åŠ¡æ ˆç©ºé—´ä¸è¶³");
}
```

## ğŸ¯ é¢„æœŸç»“æœ

ä¿®å¤ååº”è¯¥çœ‹åˆ°ï¼š
1. âœ… I2Cæ‰«æå‘ç°OLEDå’ŒMPU6050
2. âœ… OLEDæ˜¾ç¤ºå¼€æœºåŠ¨ç”»å’Œæµ‹è¯•æ–‡æœ¬
3. âœ… ä¼ æ„Ÿå™¨æ•°æ®æ­£å¸¸è¯»å–
4. âœ… è·³è·ƒæ£€æµ‹å“åº”æ­£å¸¸
5. âœ… æ¸¸æˆç•Œé¢æ­£å¸¸æ˜¾ç¤ºå’Œåˆ‡æ¢

å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æä¾›å®Œæ•´çš„ä¸²å£è¾“å‡ºæ—¥å¿—è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚
